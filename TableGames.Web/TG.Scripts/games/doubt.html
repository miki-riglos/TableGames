<style>
    .tg-doubt-bet-qty, .tg-doubt-playername {
        line-height: 50px;
    }

    .tg-doubt-playercups, .tg-doubt-usergame {
        margin-top: 20px;
    }

    .tg-doubt-dice {
        display: inline-block;
        width: 50px;
        height: 50px;
    }

    .tg-dial {
        display: inline-block;
        width: 40px;
    }
</style>

<template id="doubtTemplate">
    <div class="tg-doubt">
        <div class="row">
            <div class="col-xs-3 tg-doubt-bet-qty">
                Quantity: <span data-bind="text: quantity"></span>
            </div>
            <div class="col-xs-9" data-bind="template: { name: 'doubtDiceTemplate', data: dice }"></div>
        </div>

        <div class="tg-doubt-playercups" data-bind="foreach: playerCups">
            <div class="row">
                <div class="col-xs-3 tg-doubt-playername" data-bind="text: playerName"></div>
                <div class="col-xs-9" data-bind="template: { name: 'doubtDiceTemplate', foreach: dices }"></div>
            </div>
        </div>


        <div class="tg-doubt-usergame" data-bind="with: userGame">
            <div class="row">
                <div class="col-xs-3">Actions</div>
                <div class="col-xs-9" data-bind="template: { name: 'doubtDiceTemplate', foreach: dices }"></div>
            </div>

            <div class="row">
                <div class="col-xs-4">
                    Quantity: <span data-bind="text: $parent.actions.bet.quantity"></span>
                    <!-- ko template: { name: 'doubtDialTemplate', data: $parent.actions.bet.quantity.dial } --><!-- /ko -->
                </div>
                <div class="col-xs-4">
                    <!-- ko template: { name: 'doubtDiceTemplate', data: $parent.actions.bet.dice } --><!-- /ko -->
                    <!-- ko template: { name: 'doubtDialTemplate', data: $parent.actions.bet.dice.dial } --><!-- /ko -->
                </div>
                <div class="col-xs-4">
                    <button type="button" class="btn btn-primary" data-bind="click: $parent.actions.bet.execute">Bet</button>
                    <button type="button" class="btn btn-primary" data-bind="click: $parent.actions.doubt.execute">Doubt</button>
                    <button type="button" class="btn btn-primary" data-bind="click: $parent.actions.match.execute">Match</button>
                </div>
            </div>
        </div>

    </div>
</template>

<template id="doubtDiceTemplate">
    <div class="tg-doubt-dice">
        <svg viewBox="0 0 128 128">
            <rect width="128" height="128" fill="gray" rx="8" />
            <rect width="112" height="112" fill="white" x="8" y="8" rx="4" />

            <circle cx="30" cy="30" r="10" fill="gray" data-bind="visible: value() >= 2" />
            <circle cx="98" cy="30" r="10" fill="gray" data-bind="visible: value() >= 4" />

            <circle cx="30" cy="64" r="10" fill="gray" data-bind="visible: value() === 6" />
            <circle cx="64" cy="64" r="10" fill="gray" data-bind="visible: [1, 3, 5].indexOf(value()) !== -1" />
            <circle cx="98" cy="64" r="10" fill="gray" data-bind="visible: value() === 6" />

            <circle cx="30" cy="98" r="10" fill="gray" data-bind="visible: value() >= 4" />
            <circle cx="98" cy="98" r="10" fill="gray" data-bind="visible: value() >= 2" />
        </svg>
    </div>
</template>

<template id="doubtDialTemplate">
    <div class="tg-dial">
        <button type="button" class="btn btn-default" data-bind="click: up">
            <span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>
        </button>
        <button type="button" class="btn btn-default" data-bind="click: down">
            <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
        </button>
    </div>
</template>

<template id="doubtStatsTemplate">
    <div class="panel panel-default collapse" data-bind="attr: { 'id': room.clientId + '_stats' }">
        <div class="panel-heading">
            <span>Stats</span>
        </div>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th>
                        <span>#</span>
                    </th>
                    <!-- ko foreach: { data: playerNames, as: 'playerName' } -->
                    <th>
                        <span data-bind="text: playerName, css: { 'tg-active': playerName === $parent.activePlayerName() }"></span>
                    </th>
                    <!-- /ko -->
                </tr>
            </thead>
            <tbody data-bind="foreach: { data: stats, as: 'gameStats' }">
                <tr>
                    <td>
                        <span data-bind="text: $index() + 1"></span>
                    </td>
                    <!-- ko foreach: { data: $parent.playerNames, as: 'playerName' } -->
                    <td>
                        <span class="glyphicon glyphicon-ok" data-bind="visible: gameStats.winnerNames.indexOf(playerName) > -1" aria-hidden="true"></span>
                        <span data-bind="visible: playerName === gameStats.diceLoserName">-1</span>
                        <span data-bind="visible: playerName === gameStats.diceWinnerName">+1</span>
                    </td>
                    <!-- /ko -->
                </tr>
            </tbody>
        </table>
    </div>
</template>
